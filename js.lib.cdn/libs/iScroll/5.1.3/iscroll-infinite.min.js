/*! iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(d,a,c){var f=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||d.msRequestAnimationFrame||function(g){d.setTimeout(g,1000/60)};var b=(function(){var k={};var l=a.createElement("div").style;var i=(function(){var p=["t","webkitT","MozT","msT","OT"],n,o=0,m=p.length;for(;o<m;o++){n=p[o]+"ransform";if(n in l){return p[o].substr(0,p[o].length-1)}}return false})();function j(m){if(i===false){return false}if(i===""){return m}return i+m.charAt(0).toUpperCase()+m.substr(1)}k.getTime=Date.now||function g(){return new Date().getTime()};k.extend=function(o,n){for(var m in n){o[m]=n[m]}};k.addEvent=function(p,o,n,m){p.addEventListener(o,n,!!m)};k.removeEvent=function(p,o,n,m){p.removeEventListener(o,n,!!m)};k.prefixPointerEvent=function(m){return d.MSPointerEvent?"MSPointer"+m.charAt(9).toUpperCase()+m.substr(10):m};k.momentum=function(s,o,p,m,t,u){var n=s-o,q=c.abs(n)/p,v,r;u=u===undefined?0.0006:u;v=s+(q*q)/(2*u)*(n<0?-1:1);r=q/u;if(v<m){v=t?m-(t/2.5*(q/8)):m;n=c.abs(v-s);r=n/q}else{if(v>0){v=t?t/2.5*(q/8):0;n=c.abs(s)+v;r=n/q}}return{destination:c.round(v),duration:r}};var h=j("transform");k.extend(k,{hasTransform:h!==false,hasPerspective:j("perspective") in l,hasTouch:"ontouchstart" in d,hasPointer:d.PointerEvent||d.MSPointerEvent,hasTransition:j("transition") in l});k.isBadAndroid=/Android /.test(d.navigator.appVersion)&&!(/Chrome\/\d/.test(d.navigator.appVersion));k.extend(k.style={},{transform:h,transitionTimingFunction:j("transitionTimingFunction"),transitionDuration:j("transitionDuration"),transitionDelay:j("transitionDelay"),transformOrigin:j("transformOrigin")});k.hasClass=function(n,o){var m=new RegExp("(^|\\s)"+o+"(\\s|$)");return m.test(n.className)};k.addClass=function(n,o){if(k.hasClass(n,o)){return}var m=n.className.split(" ");m.push(o);n.className=m.join(" ")};k.removeClass=function(n,o){if(!k.hasClass(n,o)){return}var m=new RegExp("(^|\\s)"+o+"(\\s|$)","g");n.className=n.className.replace(m," ")};k.offset=function(m){var o=-m.offsetLeft,n=-m.offsetTop;while(m=m.offsetParent){o-=m.offsetLeft;n-=m.offsetTop}return{left:o,top:n}};k.preventDefaultException=function(o,n){for(var m in n){if(n[m].test(o[m])){return true}}return false};k.extend(k.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});k.extend(k.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(m){return m*(2-m)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(m){return c.sqrt(1-(--m*m))}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(n){var m=4;return(n=n-1)*n*((m+1)*n+m)+1}},bounce:{style:"",fn:function(m){if((m/=1)<(1/2.75)){return 7.5625*m*m}else{if(m<(2/2.75)){return 7.5625*(m-=(1.5/2.75))*m+0.75}else{if(m<(2.5/2.75)){return 7.5625*(m-=(2.25/2.75))*m+0.9375}else{return 7.5625*(m-=(2.625/2.75))*m+0.984375}}}}},elastic:{style:"",fn:function(m){var n=0.22,o=0.4;if(m===0){return 0}if(m==1){return 1}return(o*c.pow(2,-10*m)*c.sin((m-n/4)*(2*c.PI)/n)+1)}}});k.tap=function(o,m){var n=a.createEvent("Event");n.initEvent(m,true,true);n.pageX=o.pageX;n.pageY=o.pageY;o.target.dispatchEvent(n)};k.click=function(o){var n=o.target,m;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(n.tagName)){m=a.createEvent("MouseEvents");m.initMouseEvent("click",true,true,o.view,1,n.screenX,n.screenY,n.clientX,n.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,0,null);m._constructed=true;n.dispatchEvent(m)}};return k})();function e(j,g){this.wrapper=typeof j=="string"?a.querySelector(j):j;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={mouseWheelSpeed:20,snapThreshold:0.334,infiniteUseTransform:true,deceleration:0.004,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var h in g){this.options[h]=g[h]}this.translateZ=this.options.HWCompositing&&b.hasPerspective?" translateZ(0)":"";this.options.useTransition=b.hasTransition&&this.options.useTransition;this.options.useTransform=b.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?b.ease[this.options.bounceEasing]||b.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;if(this.options.infiniteElements){this.options.probeType=3}this.options.infiniteUseTransform=this.options.infiniteUseTransform&&this.options.useTransform;if(this.options.probeType==3){this.options.useTransition=false}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}e.prototype={version:"5.1.3",_init:function(){this._initEvents();if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}if(this.options.infiniteElements){this._initInfinite()}},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(g){if(g.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(h){if(b.eventType[h.type]!=1){if(h.button!==0){return}}if(!this.enabled||(this.initiated&&b.eventType[h.type]!==this.initiated)){return}if(this.options.preventDefault&&!b.isBadAndroid&&!b.preventDefaultException(h.target,this.options.preventDefaultException)){h.preventDefault()}var g=h.touches?h.touches[0]:h,i;this.initiated=b.eventType[h.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=b.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;i=this.getComputedPosition();this._translate(c.round(i.x),c.round(i.y));this._execEvent("scrollEnd")}else{if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=g.pageX;this.pointY=g.pageY;this._execEvent("beforeScrollStart")},_move:function(l){if(!this.enabled||b.eventType[l.type]!==this.initiated){return}if(this.options.preventDefault){l.preventDefault()}var n=l.touches?l.touches[0]:l,i=n.pageX-this.pointX,h=n.pageY-this.pointY,m=b.getTime(),g,o,k,j;this.pointX=n.pageX;this.pointY=n.pageY;this.distX+=i;this.distY+=h;k=c.abs(this.distX);j=c.abs(this.distY);if(m-this.endTime>300&&(k<10&&j<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(k>j+this.options.directionLockThreshold){this.directionLocked="h"}else{if(j>=k+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){l.preventDefault()}else{if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}}h=0}else{if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){l.preventDefault()}else{if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}}i=0}}i=this.hasHorizontalScroll?i:0;h=this.hasVerticalScroll?h:0;g=this.x+i;o=this.y+h;if(g>0||g<this.maxScrollX){g=this.options.bounce?this.x+i/3:g>0?0:this.maxScrollX}if(o>0||o<this.maxScrollY){o=this.options.bounce?this.y+h/3:o>0?0:this.maxScrollY}this.directionX=i>0?-1:i<0?1:0;this.directionY=h>0?-1:h<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(g,o);if(m-this.startTime>300){this.startTime=m;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent("scroll")}}if(this.options.probeType>1){this._execEvent("scroll")}},_end:function(m){if(!this.enabled||b.eventType[m.type]!==this.initiated){return}if(this.options.preventDefault&&!b.preventDefaultException(m.target,this.options.preventDefaultException)){m.preventDefault()}var o=m.changedTouches?m.changedTouches[0]:m,i,h,l=b.getTime()-this.startTime,g=c.round(this.x),r=c.round(this.y),q=c.abs(g-this.startX),p=c.abs(r-this.startY),j=0,n="";this.isInTransition=0;this.initiated=0;this.endTime=b.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(g,r);if(!this.moved){if(this.options.tap){b.tap(m,this.options.tap)}if(this.options.click){b.click(m)}this._execEvent("scrollCancel");return}if(this._events.flick&&l<200&&q<100&&p<100){this._execEvent("flick");return}if(this.options.momentum&&l<300){i=this.hasHorizontalScroll?b.momentum(this.x,this.startX,l,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:g,duration:0};h=this.hasVerticalScroll?b.momentum(this.y,this.startY,l,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:r,duration:0};g=i.destination;r=h.destination;j=c.max(i.duration,h.duration);this.isInTransition=1}if(this.options.snap){var k=this._nearestSnap(g,r);this.currentPage=k;j=this.options.snapSpeed||c.max(c.max(c.min(c.abs(g-k.x),1000),c.min(c.abs(r-k.y),1000)),300);g=k.x;r=k.y;this.directionX=0;this.directionY=0;n=this.options.bounceEasing}if(g!=this.x||r!=this.y){if(g>0||g<this.maxScrollX||r>0||r<this.maxScrollY){n=b.ease.quadratic}this.scrollTo(g,r,j,n);return}this._execEvent("scrollEnd")},_resize:function(){var g=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){g.refresh()},this.options.resizePolling)},resetPosition:function(h){var g=this.x,i=this.y;h=h||0;if(!this.hasHorizontalScroll||this.x>0){g=0}else{if(this.x<this.maxScrollX){g=this.maxScrollX}}if(!this.hasVerticalScroll||this.y>0){i=0}else{if(this.y<this.maxScrollY){i=this.maxScrollY}}if(g==this.x&&i==this.y){return false}this.scrollTo(g,i,h,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var h=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;var g;if(this.options.infiniteElements){this.options.infiniteLimit=this.options.infiniteLimit||c.floor(2147483645/this.infiniteElementHeight);g=-this.options.infiniteLimit*this.infiniteElementHeight+this.wrapperHeight}this.maxScrollY=g!==undefined?g:this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=b.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(h,g){if(!this._events[h]){this._events[h]=[]}this._events[h].push(g)},off:function(i,h){if(!this._events[i]){return}var g=this._events[i].indexOf(h);if(g>-1){this._events[i].splice(g,1)}},_execEvent:function(j){if(!this._events[j]){return}var h=0,g=this._events[j].length;if(!g){return}for(;h<g;h++){this._events[j][h].apply(this,[].slice.call(arguments,1))}},scrollBy:function(g,j,h,i){g=this.x+g;j=this.y+j;h=h||0;this.scrollTo(g,j,h,i)},scrollTo:function(g,j,h,i){i=i||b.ease.circular;this.isInTransition=this.options.useTransition&&h>0;if(!h||(this.options.useTransition&&i.style)){this._transitionTimingFunction(i.style);this._transitionTime(h);this._translate(g,j)}else{this._animate(g,j,h,i.fn)}},scrollToElement:function(h,i,g,l,k){h=h.nodeType?h:this.scroller.querySelector(h);if(!h){return}var j=b.offset(h);j.left-=this.wrapperOffset.left;j.top-=this.wrapperOffset.top;if(g===true){g=c.round(h.offsetWidth/2-this.wrapper.offsetWidth/2)}if(l===true){l=c.round(h.offsetHeight/2-this.wrapper.offsetHeight/2)}j.left-=g||0;j.top-=l||0;j.left=j.left>0?0:j.left<this.maxScrollX?this.maxScrollX:j.left;j.top=j.top>0?0:j.top<this.maxScrollY?this.maxScrollY:j.top;i=i===undefined||i===null||i==="auto"?c.max(c.abs(this.x-j.left),c.abs(this.y-j.top)):i;this.scrollTo(j.left,j.top,i,k)},_transitionTime:function(g){g=g||0;this.scrollerStyle[b.style.transitionDuration]=g+"ms";if(!g&&b.isBadAndroid){this.scrollerStyle[b.style.transitionDuration]="0.001s"}},_transitionTimingFunction:function(g){this.scrollerStyle[b.style.transitionTimingFunction]=g},_translate:function(g,h){if(this.options.useTransform){this.scrollerStyle[b.style.transform]="translate("+g+"px,"+h+"px)"+this.translateZ}else{g=c.round(g);h=c.round(h);this.scrollerStyle.left=g+"px";this.scrollerStyle.top=h+"px"}this.x=g;this.y=h},_initEvents:function(g){var h=g?b.removeEvent:b.addEvent,i=this.options.bindToWrapper?this.wrapper:d;h(d,"orientationchange",this);h(d,"resize",this);if(this.options.click){h(this.wrapper,"click",this,true)}if(!this.options.disableMouse){h(this.wrapper,"mousedown",this);h(i,"mousemove",this);h(i,"mousecancel",this);h(i,"mouseup",this)}if(b.hasPointer&&!this.options.disablePointer){h(this.wrapper,b.prefixPointerEvent("pointerdown"),this);h(i,b.prefixPointerEvent("pointermove"),this);h(i,b.prefixPointerEvent("pointercancel"),this);h(i,b.prefixPointerEvent("pointerup"),this)}if(b.hasTouch&&!this.options.disableTouch){h(this.wrapper,"touchstart",this);h(i,"touchmove",this);h(i,"touchcancel",this);h(i,"touchend",this)}h(this.scroller,"transitionend",this);h(this.scroller,"webkitTransitionEnd",this);h(this.scroller,"oTransitionEnd",this);h(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var h=d.getComputedStyle(this.scroller,null),g,i;if(this.options.useTransform){h=h[b.style.transform].split(")")[0].split(", ");g=+(h[12]||h[4]);i=+(h[13]||h[5])}else{g=+h.left.replace(/[^-\d.]/g,"");i=+h.top.replace(/[^-\d.]/g,"")}return{x:g,y:i}},_initWheel:function(){b.addEvent(this.wrapper,"wheel",this);b.addEvent(this.wrapper,"mousewheel",this);b.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){b.removeEvent(this.wrapper,"wheel",this);b.removeEvent(this.wrapper,"mousewheel",this);b.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(k){if(!this.enabled){return}k.preventDefault();k.stopPropagation();var i,h,l,j,g=this;if(this.wheelTimeout===undefined){g._execEvent("scrollStart")}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){g._execEvent("scrollEnd");g.wheelTimeout=undefined},400);if("deltaX" in k){if(k.deltaMode===1){i=-k.deltaX*this.options.mouseWheelSpeed;h=-k.deltaY*this.options.mouseWheelSpeed}else{i=-k.deltaX;h=-k.deltaY}}else{if("wheelDeltaX" in k){i=k.wheelDeltaX/120*this.options.mouseWheelSpeed;h=k.wheelDeltaY/120*this.options.mouseWheelSpeed}else{if("wheelDelta" in k){i=h=k.wheelDelta/120*this.options.mouseWheelSpeed}else{if("detail" in k){i=h=-k.detail/3*this.options.mouseWheelSpeed}else{return}}}}i*=this.options.invertWheelDirection;h*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){i=h;h=0}if(this.options.snap){l=this.currentPage.pageX;j=this.currentPage.pageY;if(i>0){l--}else{if(i<0){l++}}if(h>0){j--}else{if(h<0){j++}}this.goToPage(l,j);return}l=this.x+c.round(this.hasHorizontalScroll?i:0);j=this.y+c.round(this.hasVerticalScroll?h:0);if(l>0){l=0}else{if(l<this.maxScrollX){l=this.maxScrollX}}if(j>0){j=0}else{if(j<this.maxScrollY){j=this.maxScrollY}}this.scrollTo(l,j,0);if(this.options.probeType>1){this._execEvent("scroll")}},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=="string"){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on("refresh",function(){var q=0,o,j=0,h,p,k,s=0,r,u=this.options.snapStepX||this.wrapperWidth,t=this.options.snapStepY||this.wrapperHeight,g;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){p=c.round(u/2);k=c.round(t/2);while(s>-this.scrollerWidth){this.pages[q]=[];o=0;r=0;while(r>-this.scrollerHeight){this.pages[q][o]={x:c.max(s,this.maxScrollX),y:c.max(r,this.maxScrollY),width:u,height:t,cx:s-p,cy:r-k};r-=t;o++}s-=u;q++}}else{g=this.options.snap;o=g.length;h=-1;for(;q<o;q++){if(q===0||g[q].offsetLeft<=g[q-1].offsetLeft){j=0;h++}if(!this.pages[j]){this.pages[j]=[]}s=c.max(-g[q].offsetLeft,this.maxScrollX);r=c.max(-g[q].offsetTop,this.maxScrollY);p=s-c.round(g[q].offsetWidth/2);k=r-c.round(g[q].offsetHeight/2);this.pages[j][h]={x:s,y:r,width:g[q].offsetWidth,height:g[q].offsetHeight,cx:p,cy:k};if(s>this.maxScrollX){j++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=c.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=c.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var g=this.options.snapSpeed||c.max(c.max(c.min(c.abs(this.x-this.startX),1000),c.min(c.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,g)})},_nearestSnap:function(h,n){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var k=0,j=this.pages.length,g=0;if(c.abs(h-this.absStartX)<this.snapThresholdX&&c.abs(n-this.absStartY)<this.snapThresholdY){return this.currentPage}if(h>0){h=0}else{if(h<this.maxScrollX){h=this.maxScrollX}}if(n>0){n=0}else{if(n<this.maxScrollY){n=this.maxScrollY}}for(;k<j;k++){if(h>=this.pages[k][0].cx){h=this.pages[k][0].x;break}}j=this.pages[k].length;for(;g<j;g++){if(n>=this.pages[0][g].cy){n=this.pages[0][g].y;break}}if(k==this.currentPage.pageX){k+=this.directionX;if(k<0){k=0}else{if(k>=this.pages.length){k=this.pages.length-1}}h=this.pages[k][0].x}if(g==this.currentPage.pageY){g+=this.directionY;if(g<0){g=0}else{if(g>=this.pages[0].length){g=this.pages[0].length-1}}n=this.pages[0][g].y}return{x:h,y:n,pageX:k,pageY:g}},goToPage:function(g,l,h,k){k=k||this.options.bounceEasing;if(g>=this.pages.length){g=this.pages.length-1}else{if(g<0){g=0}}if(l>=this.pages[g].length){l=this.pages[g].length-1}else{if(l<0){l=0}}var j=this.pages[g][l].x,i=this.pages[g][l].y;h=h===undefined?this.options.snapSpeed||c.max(c.max(c.min(c.abs(j-this.x),1000),c.min(c.abs(i-this.y),1000)),300):h;this.currentPage={x:j,y:i,pageX:g,pageY:l};this.scrollTo(j,i,h,k)},next:function(h,j){var g=this.currentPage.pageX,i=this.currentPage.pageY;g++;if(g>=this.pages.length&&this.hasVerticalScroll){g=0;i++}this.goToPage(g,i,h,j)},prev:function(h,j){var g=this.currentPage.pageX,i=this.currentPage.pageY;g--;if(g<0&&this.hasVerticalScroll){g=0;i--}this.goToPage(g,i,h,j)},_initKeys:function(j){var h={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var g;if(typeof this.options.keyBindings=="object"){for(g in this.options.keyBindings){if(typeof this.options.keyBindings[g]=="string"){this.options.keyBindings[g]=this.options.keyBindings[g].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(g in h){this.options.keyBindings[g]=this.options.keyBindings[g]||h[g]}b.addEvent(d,"keydown",this);this.on("destroy",function(){b.removeEvent(d,"keydown",this)})},_key:function(l){if(!this.enabled){return}var g=this.options.snap,m=g?this.currentPage.pageX:this.x,k=g?this.currentPage.pageY:this.y,i=b.getTime(),h=this.keyTime||0,j=0.25,n;if(this.options.useTransition&&this.isInTransition){n=this.getComputedPosition();this._translate(c.round(n.x),c.round(n.y));this.isInTransition=false}this.keyAcceleration=i-h<200?c.min(this.keyAcceleration+j,50):0;switch(l.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){m+=g?1:this.wrapperWidth}else{k+=g?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){m-=g?1:this.wrapperWidth}else{k-=g?1:this.wrapperHeight}break;case this.options.keyBindings.end:m=g?this.pages.length-1:this.maxScrollX;k=g?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:m=0;k=0;break;case this.options.keyBindings.left:m+=g?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:k+=g?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:m-=g?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:k-=g?1:5+this.keyAcceleration>>0;break;default:return}if(g){this.goToPage(m,k);return}if(m>0){m=0;this.keyAcceleration=0}else{if(m<this.maxScrollX){m=this.maxScrollX;this.keyAcceleration=0}}if(k>0){k=0;this.keyAcceleration=0}else{if(k<this.maxScrollY){k=this.maxScrollY;this.keyAcceleration=0}}this.scrollTo(m,k,0);this.keyTime=i},_animate:function(p,o,j,g){var m=this,l=this.x,k=this.y,h=b.getTime(),n=h+j;function i(){var q=b.getTime(),s,r,t;if(q>=n){m.isAnimating=false;m._translate(p,o);if(!m.resetPosition(m.options.bounceTime)){m._execEvent("scrollEnd")}return}q=(q-h)/j;t=g(q);s=(p-l)*t+l;r=(o-k)*t+k;m._translate(s,r);if(m.isAnimating){f(i)}if(m.options.probeType==3){m._execEvent("scroll")}}this.isAnimating=true;i()},_initInfinite:function(){var g=this.options.infiniteElements;this.infiniteElements=typeof g=="string"?a.querySelectorAll(g):g;this.infiniteLength=this.infiniteElements.length;this.infiniteMaster=this.infiniteElements[0];this.infiniteElementHeight=this.infiniteMaster.offsetHeight;this.infiniteHeight=this.infiniteLength*this.infiniteElementHeight;this.options.cacheSize=this.options.cacheSize||1000;this.infiniteCacheBuffer=c.round(this.options.cacheSize/4);this.options.dataset.call(this,0,this.options.cacheSize);this.on("refresh",function(){var h=c.ceil(this.wrapperHeight/this.infiniteElementHeight);this.infiniteUpperBufferSize=c.floor((this.infiniteLength-h)/2);this.reorderInfinite()});this.on("scroll",this.reorderInfinite)},reorderInfinite:function(){var g=-this.y+this.wrapperHeight/2;var n=c.max(c.floor(-this.y/this.infiniteElementHeight)-this.infiniteUpperBufferSize,0),l=c.floor(n/this.infiniteLength),h=n-l*this.infiniteLength;var m=0;var k=0;var o=[];var j=c.floor(n/this.infiniteCacheBuffer);while(k<this.infiniteLength){m=k*this.infiniteElementHeight+l*this.infiniteHeight;if(h>k){m+=this.infiniteElementHeight*this.infiniteLength}if(this.infiniteElements[k]._top!==m){this.infiniteElements[k]._phase=m/this.infiniteElementHeight;if(this.infiniteElements[k]._phase<this.options.infiniteLimit){this.infiniteElements[k]._top=m;if(this.options.infiniteUseTransform){this.infiniteElements[k].style[b.style.transform]="translate(0, "+m+"px)"+this.translateZ}else{this.infiniteElements[k].style.top=m+"px"}o.push(this.infiniteElements[k])}}k++}if(this.cachePhase!=j&&(j===0||n-this.infiniteCacheBuffer>0)){this.options.dataset.call(this,c.max(j*this.infiniteCacheBuffer-this.infiniteCacheBuffer,0),this.options.cacheSize)}this.cachePhase=j;this.updateContent(o)},updateContent:function(j){if(this.infiniteCache===undefined){return}for(var h=0,g=j.length;h<g;h++){this.options.dataFiller.call(this,j[h],this.infiniteCache[j[h]._phase])}},updateCache:function(m,j){var k=this.infiniteCache===undefined;this.infiniteCache={};for(var h=0,g=j.length;h<g;h++){this.infiniteCache[m++]=j[h]}if(k){this.updateContent(this.infiniteElements)}},handleEvent:function(g){switch(g.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(g);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(g);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(g);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(g);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(g);break;case"keydown":this._key(g);break;case"click":if(!g._constructed){g.preventDefault();g.stopPropagation()}break}}};e.utils=b;if(typeof module!="undefined"&&module.exports){module.exports=e}else{d.IScroll=e}})(window,document,Math);